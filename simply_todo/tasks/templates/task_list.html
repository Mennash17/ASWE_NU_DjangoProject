{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Simply Todo</title>
    <link rel="stylesheet" href="{% static 'tasks/styles.css' %}">
    <style>
        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            background-color: #f0f2f5;
        }

        header {
            background-color: #0066cc;
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            letter-spacing: 1px;
        }

        .main-content {
            display: flex;
            justify-content: space-between;
            padding: 30px;
            gap: 30px;
            flex-wrap: wrap;
        }

        .task-form-box {
            flex: 1;
            min-width: 300px;
            background-color: #ffffff;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .task-form-box h2 {
            margin-bottom: 20px;
            color: #333;
        }

        .task-form label {
            display: block;
            margin-bottom: 6px;
            font-weight: bold;
        }

        .task-form input[type="text"],
        .task-form textarea {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 6px;
            font-size: 14px;
        }

        .task-form input[type="checkbox"] {
            margin-right: 8px;
        }

        .btn {
            background-color: #0066cc;
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: 0.2s;
        }

        .btn:hover {
            background-color: #004999;
        }

        .task-list {
            flex: 2;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .task-card {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.07);
            position: relative;
        }

        .task-card h3 {
            margin: 0;
            font-size: 18px;
            color: #333;
        }

        .task-card p {
            margin: 10px 0;
            font-size: 14px;
            color: #555;
        }

        .task-card .status {
            font-size: 12px;
            font-weight: bold;
            color: #666;
        }

        .task-actions {
            position: absolute;
            top: 10px;
            right: 10px;
        }

        .task-actions button {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 18px;
            margin-left: 10px;
        }

        .task-actions .btn-edit {
            color: #ff9900;
        }

        .task-actions .btn-delete {
            color: #e60026;
        }

        .task-card.completed {
            background-color: #e8f7e4;
            border-left: 5px solid #28a745;
        }
    </style>
</head>
<body>

<header>
    Simply Todo
</header>

<div class="main-content">

    <!-- Form -->
    <div class="task-form-box">
        <h2>Add Task</h2>
        <form method="post" class="task-form">
            {% csrf_token %}
            <label for="id_title">Title</label>
            {{ form.title }}

            <label for="id_description">Description</label>
            {{ form.description }}

            <label for="id_completed">{{ form.completed }} Completed</label>

            <button type="submit" class="btn">Add Task</button>
        </form>
    </div>

    <!-- Tasks -->
    <div class="task-list">
        {% for task in tasks %}
        <div class="task-card {% if task.completed %}completed{% endif %}">
            <div class="task-actions">
                <button class="btn-edit" onclick="openEditModal({{ task.id }}, '{{ task.title }}', '{{ task.description }}', {{ task.completed|yesno:'true,false' }})">‚úèÔ∏è</button>
                <button class="btn-delete" onclick="openDeleteModal({{ task.id }}, '{{ task.title }}')">üóëÔ∏è</button>
            </div>
            <h3>{{ task.title }}</h3>
            <p>{{ task.description }}</p>
            <span class="status">{% if task.completed %}‚úÖ Completed{% else %}‚ùå Not Done{% endif %}</span>
        </div>
        {% endfor %}
    </div>
</div>

<!-- (Popup modals for edit/delete same as ŸÇÿ®ŸÑ ŸÉÿØŸá ŸÑŸà ÿ≠ÿßÿ®ÿ© ÿ™ŸÉŸÖŸÑŸä) -->
<!-- Edit Modal -->
<div id="editModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeEditModal()">&times;</span>
        <h2>Edit Task</h2>
        <form id="editForm" method="post">
            {% csrf_token %}
            <label>Title</label>
            <input type="text" name="title" id="editTitle" required>

            <label>Description</label>
            <textarea name="description" id="editDescription" required></textarea>

            <label>
                <input type="checkbox" name="completed" id="editCompleted"> Completed
            </label>

            <input type="hidden" name="id" id="editId">
            <button type="submit" class="btn">Update</button>
        </form>
    </div>
</div>

<!-- Delete Modal -->
<div id="deleteModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeDeleteModal()">&times;</span>
        <h2>Confirm Delete</h2>
        <p>Are you sure you want to delete: <strong id="deleteTitle"></strong>?</p>
        <form id="deleteForm" method="post">
            {% csrf_token %}
            <input type="hidden" name="delete_id" id="deleteId">
            <button type="submit" class="btn btn-delete">Delete</button>
        </form>
    </div>
</div>

</body>
<script>
    function openEditModal(id, title, description, completed) {
        document.getElementById('editModal').style.display = 'block';
        document.getElementById('editId').value = id;
        document.getElementById('editTitle').value = title;
        document.getElementById('editDescription').value = description;
        document.getElementById('editCompleted').checked = completed;
        document.getElementById('editForm').action = `/update/${id}/`;
    }

    function closeEditModal() {
        document.getElementById('editModal').style.display = 'none';
    }

    function openDeleteModal(id, title) {
        document.getElementById('deleteModal').style.display = 'block';
        document.getElementById('deleteId').value = id;
        document.getElementById('deleteTitle').innerText = title;
        document.getElementById('deleteForm').action = `/delete/${id}/`;
    }

    function closeDeleteModal() {
        document.getElementById('deleteModal').style.display = 'none';
    }

    window.onclick = function(event) {
        if (event.target == document.getElementById('editModal')) closeEditModal();
        if (event.target == document.getElementById('deleteModal')) closeDeleteModal();
    }
</script>

</html>
